<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WBRHTV97');</script>
<!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Your SQL Cheat Sheet</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WBRHTV97"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md border border-gray-200 text-center">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Almost There!</h1>
        <p class="text-gray-600 mb-8">
            Click the button below to download your free SQL Basics Cheat Sheet.
        </p>

        <a id="downloadButton"
           href="https://learnsql.com/blog/sql-basics-cheat-sheet/sql-basics-cheat-sheet-a4.pdf"
           target="_blank"
           class="inline-block bg-green-600 text-white py-3 px-8 rounded-lg text-lg font-semibold hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out shadow-md">
            Download SQL Cheat Sheet
        </a>

        <p class="text-gray-500 mt-8">
            Once downloaded, you'll be redirected to our thank you page.
        </p>
    </div>

    <script>
        // Initialize or retrieve tracking data from localStorage
        let trackingData = JSON.parse(localStorage.getItem('trackingData')) || {
            pageVisits: {},
            formSubmissions: 0,
            downloadClicks: 0,
            successfulDownloads: 0
        };

        // Function to track page visits
        function trackPageVisit(pageName) {
            trackingData.pageVisits[pageName] = (trackingData.pageVisits[pageName] || 0) + 1;
            console.log(`Page visit tracked: ${pageName}. Total visits: ${trackingData.pageVisits[pageName]}`);
            localStorage.setItem('trackingData', JSON.stringify(trackingData));
        }

        // Track page visit for download.html
        trackPageVisit('download.html');

        const downloadButton = document.getElementById('downloadButton');
        downloadButton.addEventListener('click', function() {
            // Track download button click
            trackingData.downloadClicks++;
            console.log('Download button clicked!');
            console.log(`Total download clicks: ${trackingData.downloadClicks}`);
            localStorage.setItem('trackingData', JSON.stringify(trackingData));

            // In a real scenario, you might have a server-side endpoint
            // that serves the file and then redirects. Since we're directly
            // linking to a PDF, we'll simulate the "successful download"
            // by incrementing the count and then immediately redirecting
            // to the thank you page after a short delay.
            // A more robust solution would involve checking if the file
            // actually started downloading or was accessed.

            // Simulate successful download after a short delay
            setTimeout(() => {
                trackingData.successfulDownloads++;
                console.log('Simulated successful file access/download!');
                console.log(`Total successful downloads: ${trackingData.successfulDownloads}`);
                localStorage.setItem('trackingData', JSON.stringify(trackingData));
                window.location.href = 'thankyou.html';
            }, 500); // Redirect after 0.5 seconds
        });
    </script>
</body>
</html>
